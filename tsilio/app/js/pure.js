var $p=function(){var e=arguments,t=e[0],n=!1;return"string"==typeof t?n=e[1]||!1:!t||t[0]||t.length||(t=[t]),$p.core(t,n)},pure=$p;$p.core=function(e,t,n){function r(e){throw"undefined"!=typeof console&&console.log(e),"pure error: "+e}function o(e){return e.outerHTML||function(e){var t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}(e)}function i(e,t){return function(n){return e(String(t.call(n.item||n.context,n)))}}function u(e,t){return"string"==typeof e&&(t=e,e=!1),(e||document).querySelectorAll(t)}function s(e,t){return function(n){var r,o,i,u,s,c=[e[0]],l=e.length;try{for(s=1;s<l;s++)r=t[s].call(this,n),o=e[s],""===r&&(i=c[c.length-1],(u=i.search(/[^\s]+=\"?$/))>-1&&(c[c.length-1]=i.substring(0,u),o=o.substr(1))),c[c.length]=r,c[c.length]=o;return c.join("")}catch(e){return console&&console.log&&console.log(e.stack||e.message+" ("+e.type+(e.arguments?", "+e.arguments.join("-"):"")+"). Use Firefox or Chromium/Chrome to get a full stack of the error. "),""}}}function c(e){var t=e.match(/^(\w+)\s*<-\s*(\S+)?$/);return null===t&&r('bad loop spec: "'+e+'"'),"item"===t[1]&&r('"item<-..." is a reserved word for the current running iteration.\n\nPlease choose another name for your loop.'),t[2]&&"context"!==t[2].toLowerCase()?t[2]&&0===t[2].indexOf("context")&&(t[2]=l(t[2].replace(/^context\.?/,""))):t[2]=function(e){return e.context},{name:t[1],sel:t[2]}}function l(e){if("function"==typeof e)return function(t){return t=e.call(t.item||t.context||t,t),t||0===t?t:""};var t,n=e.match(/^[\da-zA-Z\$_\@\#][\w\$:\-\#]*(\.[\w\$:\-\#]*[^\.])*$/),r=!1,o=e,i=[],u=[],c=0;if(null===n){if(/\'|\"/.test(o.charAt(0))){if(/\'|\"/.test(o.charAt(o.length-1)))return t=o.substring(1,o.length-1),function(){return t}}else for(;null!==(n=o.match(/#\{([^{}]+)\}/));)r=!0,i[c++]=o.slice(0,n.index),u[c]=l(n[1]),o=o.slice(n.index+n[0].length,o.length);return r?(i[c]=o,s(i,u)):function(){return e}}return n=e.split("."),function(e){var t=e.context||e,r=e[n[0]];e=0;var o;if(r&&void 0!==r.item){if(e+=1,"pos"===n[e])return r.pos;t=r.item}for(r=n.length;e<r&&t;)o=t[n[e]],t="function"==typeof o?o.call(t):o,e++;return t||0===t?t:""}}function f(e,t,i){var u,s,c,l,f,p,a,d,h,m,y=[];if("string"==typeof t){if(u=t,(f=t.match(_))||r("bad selector syntax: "+t),s=f[1],c=f[2],l=f[3],f=f[4],"."===c||!c&&l?y[0]=e:y=n.find(e,c),!y||0===y.length)return r('The node "'+t+'" was not found in the template:\n'+o(e).replace(/\t/g,"  "))}else s=t.prepend,l=t.attr,f=t.append,y=[e];return(s||f)&&(s&&f?r("append/prepend cannot take place at the same time"):i?r("no append/prepend/replace modifiers allowed for loop target"):f&&i&&r("cannot append with loop (sel: "+u+")")),l?(d=/^style$/i.test(l),m=(h=/^class$/i.test(l))?"className":l,p=function(e,t){if(e.setAttribute(N+l,t),e[m]&&!d)try{e[m]=""}catch(e){}1===e.nodeType&&(e.removeAttribute(l),h&&e.removeAttribute(m))},a=d||h?d?function(e){return e.style.cssText}:function(e){return e.className}:function(e){return e.getAttribute(l)},e=function(e){return e.replace(/\"/g,"&quot;")},s=s?function(e,t){p(e,t+a(e))}:f?function(e,t){p(e,a(e)+t)}:function(e,t){p(e,t)}):(s=i?function(e,t){var n=e.parentNode;n?(n.insertBefore(document.createTextNode(t),e.nextSibling),n.removeChild(e)):r("The template root, can't be looped.")}:s?function(e,t){e.insertBefore(document.createTextNode(t),e.firstChild)}:f?function(e,t){e.appendChild(document.createTextNode(t))}:function(e,t){for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))},e=function(e){return e}),{attr:l,nodes:y,set:s,sel:u,quotefn:e}}function p(e,t){var n,r=x+t+":";for(n=0;n<e.nodes.length;n++)e.set(e.nodes[n],r)}function a(e,t,n,o,i){return function(u){var s,c,l=t(u),f=u[e],p={items:l},a=0,d=[],h=function(e,t,r,o){var i=u.pos,s=u.item,c=u.items;u.pos=t.pos=e,u.item=t.item=l[e],u.items=l,void 0!==o&&(u.length=o),"function"==typeof r&&!1===r.call(u.item,u)?a++:(d.push(n.call(u.item,u)),u.pos=i,u.item=s,u.items=c)};if(u[e]=p,O(l))for(s=l.length||0,"function"==typeof o&&l.sort(function(e,t){return o.call(u,e,t)}),c=0;c<s;c++)h(c,p,i,s-a);else{l&&void 0!==o&&r("sort is only available on arrays, not objects");for(s in l)l.hasOwnProperty(s)&&h(s,p,i)}return void 0!==f?u[e]=f:delete u[e],d.join("")}}function d(e,t,n,o){var u,s,h,y,g,v=!1;for(y in n)n.hasOwnProperty(y)&&("sort"===y?s=n.sort:"filter"===y?h=n.filter:v?r("cannot have more than one loop on a target"):(u=y,v=!0));if(u||r("Error in the selector: "+t+"\nA directive action must be a string, a function or a loop(<-)"),"string"==typeof(v=n[u])||"function"==typeof v)return n={},n[u]={root:v},d(e,t,n,o);for(n=c(u),u=l(n.sel),e=f(e,t,!0),t=e.nodes,T=0;T<t.length;T++)y=t[T],g=m(y,v),o[o.length]=i(e.quotefn,a(n.name,u,g,s,h)),e.nodes=[y],p(e,o.length-1);return e}function h(e,t){var n,r,o,i,u,s,c,f,p=e.getElementsByTagName("*"),a=[],d={a:[],l:{}};for(o=-1,i=p.length;o<i;o++)if(c=o>-1?p[o]:e,1===c.nodeType&&""!==c.className)for(f=c.className.split(" "),u=0,s=f.length;u<s;u++)n=f[u],!1!==(n=function(e,n){var r=e.match(_);r={prepend:!!r[1],prop:r[2],attr:r[3]||A[n],append:!!r[4],sel:e};var o,i,u;for(o=d.a.length-1;o>=0;o--)if(i=d.a[o],void 0!==(u=(u=i.l[0])&&u[r.prop])){r.prop=i.p+"."+r.prop,!0===d.l[r.prop]&&(u=u[0]);break}return(void 0!==u||""!==(u=l(r.prop)(O(t)?t[0]:t)))&&(O(u)?(d.a.push({l:u,p:r.prop}),d.l[r.prop]=!0,r.t="loop"):r.t="str",r)}(n,c.tagName))&&(r=/nodevalue/i.test(n.attr),(n.sel.indexOf("@")>-1||r)&&(c.className=c.className.replace("@"+n.attr,""),r&&(n.attr=!1)),a.push({n:c,cspec:n}));return a}function m(e,t,n,r){var u,c,y,g,v,$,T,b,_,A=[],O=[];if(r=r||n&&h(e,n),n)for(;r.length>0;)if(y=r[0].cspec,g=r[0].n,r.splice(0,1),"str"===y.t)g=f(g,y,!1),p(g,A.length),A[A.length]=i(g.quotefn,l(y.prop));else for($=l(y.sel),g=f(g,y,!0),v=g.nodes,u=0,c=v.length;u<c;u++)T=v[u],b=m(T,!1,n,r),A[A.length]=i(g.quotefn,a(y.sel,$,b)),g.nodes=[T],p(g,A.length-1);for(_ in t)if(t.hasOwnProperty(_)){n=0,r=t[_],y=_.split(/\s*,\s*/),$=y.length;do{"function"==typeof r||"string"==typeof r?(_=y[n],g=f(e,_,!1),p(g,A.length),A[A.length]=i(g.quotefn,l(r))):d(e,_,r,A)}while(++n<$)}for(e=o(e),e=e.replace(/<([^>]+)\s(value\=""|selected)\s?([^>]*)>/gi,"<$1 $3>"),e=e.split(N).join(""),e=e.split(x),n=1;n<e.length;n++)t=e[n],O[n]=A[parseInt(t,10)],e[n]=t.substring(t.indexOf(":")+1);return s(e,O)}function y(e,t,n){var r=m((n||this[0]).cloneNode(!0),e,t);return function(e){return r({context:e})}}function g(e,t){var r,o,i="function"==typeof t&&t;for(r=0,o=this.length;r<o;r++)this[r]=$(this[r],(i||n.compile(t,!1,this[r]))(e,!1));return this}function v(e,t){var r,o,i=n.compile(t,e,this[0]);for(r=0,o=this.length;r<o;r++)this[r]=$(this[r],i(e,!1));return this}function $(e,t){var n,r,o=e.parentNode,i=0;switch(o||(o=document.createElement("DIV"),o.appendChild(e)),e.tagName){case"BODY":return o.removeChild(e),o.innerHTML+=t,o.getElementsByTagName("BODY")[0];case"TBODY":case"THEAD":case"TFOOT":t="<TABLE>"+t+"</TABLE>",i=1;break;case"TR":t="<TABLE><TBODY>"+t+"</TBODY></TABLE>",i=2;break;case"TD":case"TH":t="<TABLE><TBODY><TR>"+t+"</TR></TBODY></TABLE>",i=3;break;case"OPTGROUP":case"OPTION":t="<SELECT>"+t+"</SELECT>",i=1}for(r=document.createElement("SPAN"),r.style.display="none",document.body.appendChild(r),r.innerHTML=t,n=r.firstChild;i--;)n=n.firstChild;return o.insertBefore(n,e),o.removeChild(e),document.body.removeChild(r),e=n}var T,b=[],x="_s"+Math.floor(1e6*Math.random())+"_",N="_a"+Math.floor(1e6*Math.random())+"_",_=/^(\+)?([^\@\+]+)?\@?([^\+]+)?(\+)?$/,A={IMG:"src",INPUT:"value"},O=Array.isArray?function(e){return Array.isArray(e)}:function(e){return"[object Array]"===Object.prototype.toString.call(e)};switch(n=n||function(){var e=$p.plugins,t=function(){};return t.prototype=e,t.prototype.compile=e.compile||y,t.prototype.render=e.render||g,t.prototype.autoRender=e.autoRender||v,t.prototype.find=e.find||u,t.prototype._compiler=m,t.prototype._error=r,new t}(),typeof e){case"string":b=n.find(t||document,e),0===b.length&&r('The template "'+e+'" was not found');break;case"undefined":r("The root of the template is undefined, check your selector");break;default:b=e}for(T=0,e=b.length;T<e;T++)n[T]=b[T];return n.length=e,n},$p.plugins={},$p.libs={dojo:function(){return function(e,t){return dojo.query(t,e)}},domassistant:function(){return DOMAssistant.attach({publicMethods:["compile","render","autoRender"],compile:function(e,t){return $p([this]).compile(e,t)},render:function(e,t){return $($p([this]).render(e,t))[0]},autoRender:function(e,t){return $($p([this]).autoRender(e,t))[0]}}),function(e,t){return $(e).cssSelect(t)}},ext:function(){return function(e,t){return Ext.query(t,e)}},jquery:function(){return jQuery.fn.extend({directives:function(e){return this._pure_d=e,this},compile:function(e,t){return $p(this).compile(this._pure_d||e,t)},render:function(e,t){return jQuery($p(this).render(e,this._pure_d||t))},autoRender:function(e,t){return jQuery($p(this).autoRender(e,this._pure_d||t))}}),function(e,t){return jQuery(e).find(t)}},mootools:function(){return Element.implement({compile:function(e,t){return $p(this).compile(e,t)},render:function(e,t){return $p([this]).render(e,t)},autoRender:function(e,t){return $p([this]).autoRender(e,t)}}),function(e,t){return $(e).getElements(t)}},prototype:function(){return Element.addMethods({compile:function(e,t,n){return $p([e]).compile(t,n)},render:function(e,t,n){return $p([e]).render(t,n)},autoRender:function(e,t,n){return $p([e]).autoRender(t,n)}}),function(e,t){return e=e===document?e.body:e,"string"==typeof e?$$(e):$(e).select(t)}},sizzle:function(){return function(e,t){return Sizzle(t,e)}},sly:function(){return function(e,t){return Sly(t,e)}},yui:function(){return void 0===document.querySelector&&YUI().use("node",function(e){$p.plugins.find=function(t,n){return e.NodeList.getDOMNodes(e.one(t).all(n))}}),YUI.add("pure-yui",function(e){e.Node.prototype.directives=function(e){return this._pure_d=e,this},e.Node.prototype.compile=function(e,t){return $p([this._node]).compile(this._pure_d||e,t)},e.Node.prototype.render=function(t,n){return e.one($p([this._node]).render(t,this._pure_d||n))},e.Node.prototype.autoRender=function(t,n){return e.one($p([this._node]).autoRender(t,this._pure_d||n))}},"0.1",{requires:["node"]}),!0}},function(){var e,t="undefined"!=typeof dojo&&"dojo"||"undefined"!=typeof DOMAssistant&&"domassistant"||"undefined"!=typeof Ext&&"ext"||"undefined"!=typeof jQuery&&"jquery"||"undefined"!=typeof MooTools&&"mootools"||"undefined"!=typeof Prototype&&"prototype"||"undefined"!=typeof Sizzle&&"sizzle"||"undefined"!=typeof Sly&&"sly"||"undefined"!=typeof YUI&&"yui";if(t&&(e=$p.libs[t]()),void 0===document.querySelector)if("function"==typeof e)$p.plugins.find=e;else if(!e)throw"you need a JS library with a CSS selector engine";"undefined"!=typeof exports&&(exports.$p=$p)}();